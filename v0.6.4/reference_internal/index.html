<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internal API reference · Merzbild</title><meta name="title" content="Internal API reference · Merzbild"/><meta property="og:title" content="Internal API reference · Merzbild"/><meta property="twitter:title" content="Internal API reference · Merzbild"/><meta name="description" content="Documentation for Merzbild."/><meta property="og:description" content="Documentation for Merzbild."/><meta property="twitter:description" content="Documentation for Merzbild."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Merzbild</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview_capabilities/">Overview of capabilities</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../overview_blocks/">Overview of basic building blocks</a></li><li><a class="tocitem" href="../overview_fixedweight/">Fixed-weight DSMC simulations</a></li><li><a class="tocitem" href="../overview_varweight/">Variable-weight DSMC simulations</a></li><li><a class="tocitem" href="../overview_1d/">1D DSMC simulations</a></li><li><a class="tocitem" href="../overview_fp/">Fokker-Planck simulations</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../contiguous_indexing/">Contiguous indexing</a></li><li><a class="tocitem" href="../modelling_ionization/">Modelling ionization reactions</a></li></ul></li><li><span class="tocitem">API reference</span><ul><li><a class="tocitem" href="../reference_public/">Public API reference</a></li><li class="is-active"><a class="tocitem" href>Internal API reference</a><ul class="internal"><li><a class="tocitem" href="#Particle-indexing"><span>Particle indexing</span></a></li><li><a class="tocitem" href="#Loading-species-and-interaction-data"><span>Loading species and interaction data</span></a></li><li><a class="tocitem" href="#Sampling"><span>Sampling</span></a></li><li><a class="tocitem" href="#Collision-computations"><span>Collision computations</span></a></li><li><a class="tocitem" href="#Electron-neutral-interactions"><span>Electron-neutral interactions</span></a></li><li><a class="tocitem" href="#Merging"><span>Merging</span></a></li><li><a class="tocitem" href="#Grids"><span>Grids</span></a></li><li><a class="tocitem" href="#Particle-movement"><span>Particle movement</span></a></li><li><a class="tocitem" href="#Particle-surface-interactions"><span>Particle-surface interactions</span></a></li><li><a class="tocitem" href="#I/O"><span>I/O</span></a></li><li><a class="tocitem" href="#Constants"><span>Constants</span></a></li><li><a class="tocitem" href="#Misc"><span>Misc</span></a></li><li><a class="tocitem" href="#NNLS"><span>NNLS</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../benchmarks/">Benchmarks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API reference</a></li><li class="is-active"><a href>Internal API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internal API reference</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Merzbild.jl-internal-API-reference"><a class="docs-heading-anchor" href="#Merzbild.jl-internal-API-reference">Merzbild.jl internal API reference</a><a id="Merzbild.jl-internal-API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#Merzbild.jl-internal-API-reference" title="Permalink"></a></h1><p>The public API functions are exported by the module</p><h2 id="Particle-indexing"><a class="docs-heading-anchor" href="#Particle-indexing">Particle indexing</a><a id="Particle-indexing-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-indexing" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.map_cont_index" href="#Merzbild.map_cont_index"><code>Merzbild.map_cont_index</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">map_cont_index(particle_indexer, i)</code></pre><p>Maps a continuous index in the range <code>[0, n_local-1]</code> to an index in the particle array given a <code>ParticleIndexer</code> instance describing how particle indices are split across 2 groups.</p><p><strong>Positional arguments</strong></p><ul><li><code>particle_indexer</code>: the <code>ParticleIndexer</code> instance</li><li><code>i</code>: the index to map</li></ul></div></section><section><div><pre><code class="language-julia hljs">map_cont_index(pia, cell, species, i)</code></pre><p>Maps a continuous index in the range <code>[0, n_local-1]</code> to an index in the particle array for particles of a specific species in a specific cell.</p><p><strong>Positional arguments</strong></p><ul><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particles are located</li><li><code>species</code>: the index of the particles&#39; species</li><li><code>i</code>: the index to map</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_indexer_new_lower_count" href="#Merzbild.update_particle_indexer_new_lower_count"><code>Merzbild.update_particle_indexer_new_lower_count</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_particle_indexer_new_lower_count(pia, cell, species, new_lower_count)</code></pre><p>Update a <code>ParticleIndexerArray</code> instance when the particle count of a given species in a given cell is reduced.</p><p><strong>Positional arguments</strong></p><ul><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particles are located</li><li><code>species</code>: the index of the particles&#39; species</li><li><code>new_lower_count</code>: the new number of particles of the given species in the given cell</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_indexer_new_particle" href="#Merzbild.update_particle_indexer_new_particle"><code>Merzbild.update_particle_indexer_new_particle</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_particle_indexer_new_particle(pia, cell, species)</code></pre><p>Update a <code>ParticleIndexerArray</code> instance when a particle of a given species in a given cell is created. This places the particle index in the 2-nd group of particle indices in the <code>ParticleIndexer</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particle is created</li><li><code>species</code>: the index of the species of which the particle is created</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex" href="#Base.getindex"><code>Base.getindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.getindex(pv::ParticleVector, i)</code></pre><p>Returns the underlying particle in a <code>ParticleVector</code> instance with index <code>i</code>.</p><p>Is usually called as <code>ParticleVector[i]</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>i</code>: the index of the particle to be selected</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.setindex!" href="#Base.setindex!"><code>Base.setindex!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.setindex!(pv::ParticleVector, p::Particle, i::Integer)</code></pre><p>Set the underlying particle in a <code>ParticleVector</code> instance with index <code>i</code> to a new particle.</p><p>Is usually called as <code>ParticleVector[i] = p</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>p</code>: the <code>Particle</code> instance to write</li><li><code>i</code>: the index of the particle to be written to</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length" href="#Base.length"><code>Base.length</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.length(pv::ParticleVector)</code></pre><p>Returns the length of a <code>ParticleVector</code> instance.</p><p>Is usually called as <code>length(ParticleVector)</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.resize!" href="#Base.resize!"><code>Base.resize!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.resize!(pv::ParticleVector, n::Integer)</code></pre><p>Resize a <code>ParticleVector</code> instance.</p><p>Is usually called as <code>resize!(ParticleVector, n)</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>n</code>: the new length of the <code>ParticleVector</code> instance (i.e. the length of all the vector fields of the instance)</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_particle_buffer_new_particle(pv::ParticleVector, position)</code></pre><p>Update the buffer in a <code>ParticleVector</code> instance when a new particle is created. This writes the index of the new particle (the last index stored in the active part of the buffer) to the <code>index</code> vector at position <code>position</code>, and reduces the length of the active part of the buffer by 1.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>position</code>: the position in the <code>index</code> vector to which to write the index of the new particle</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_particle_buffer_new_particle(pv::ParticleVector, pia, species)</code></pre><p>Update the buffer in a <code>ParticleVector</code> instance when a new particle is created at the end of the particle array, and reduces the length of the active part of the buffer by 1. This assumes that the <code>pia</code> structure has already an updated particle count (that accounts for the newly created particle), as the index of the new particle taken from the buffer is written to <code>pv.index.[pia.n_total[species]]</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>species</code>: the index of the species of which a new particle is created</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_particle_buffer_new_particle(pv::Vector{Particle}, pia, species)</code></pre><p>Dummy function in case <code>Vector{Particle}</code> is used and not a <code>ParticleVector</code>, just to make the simplest 0-D examples work.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_particle_buffer_new_particle(pv::Vector{Particle}, position)</code></pre><p>Dummy function in case <code>Vector{Particle}</code> is used and not a <code>ParticleVector</code>, just to make the simplest 0-D examples work.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_buffer_index_new_particle!" href="#Merzbild.update_buffer_index_new_particle!"><code>Merzbild.update_buffer_index_new_particle!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_buffer_index_new_particle!(pv, pia, cell, species)</code></pre><p>Update a <code>ParticleIndexerArray</code> and the buffer in a <code>ParticleVector</code> instance when a particle of a given species in a given cell is created. See the documentation of <a href="#Merzbild.update_particle_indexer_new_particle"><code>update_particle_indexer_new_particle</code></a> and <a href="#Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any}"><code>update_particle_buffer_new_particle</code></a></p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particle is created</li><li><code>species</code>: the index of the species of which the particle is created</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.delete_particle!" href="#Merzbild.delete_particle!"><code>Merzbild.delete_particle!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_particle!(pv::ParticleVector, pia, cell, species, i)</code></pre><p>Delete particle with index i of species <code>species</code> in cell <code>cell</code> and update the particle indexers and buffers accordingly. This changes the ordering of the non-deleted particles in the cell.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particle is deleted</li><li><code>species</code>: the index of the species of which the particle is deleted</li><li><code>i</code>: the index of the particle to delete</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.delete_particle_end!" href="#Merzbild.delete_particle_end!"><code>Merzbild.delete_particle_end!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_particle_end!(pv::ParticleVector, pia, cell, species)</code></pre><p>Delete the last particle of species <code>species</code> in cell <code>cell</code>: if particles are present in the 2nd group of the indices stored in the <code>ParticleIndexer</code> instance, it will delete the last particle in that group; otherwise it will delete the last particle in the 1st group of particles pointed to by the <code>ParticleIndexer</code> instance. If no particles are present in the cell, the function does nothing. This does not set the value of the <code>contiguous</code> field of <code>pia</code> to <code>false</code> even if <code>pia</code> becomes discontinuous; this has to be done outside of this function.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particle is deleted</li><li><code>species</code>: the index of the species of which the particle is deleted</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.delete_particle_end_group1!" href="#Merzbild.delete_particle_end_group1!"><code>Merzbild.delete_particle_end_group1!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_particle_end_group1!(pv::ParticleVector, pia, cell, species)</code></pre><p>Delete particle with index <code>pia.indexer[cell, species].end1</code><code>of species</code>species<code>in cell</code>cell<code>and update the particle indexers and buffers accordingly (i.e. delete the last particle in the 1st group of particles of a given species in a given cell). This also sets the weight of the deleted particle to 0. If no particles are present in the 1st group of particles, the function does nothing. This does not set the value of the</code>contiguous<code>field of</code>pia<code>to</code>false<code>even if</code>pia` becomes discontinuous; this has to be done outside of this function.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particle is deleted</li><li><code>species</code>: the index of the species of which the particle is deleted</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.delete_particle_end_group2!" href="#Merzbild.delete_particle_end_group2!"><code>Merzbild.delete_particle_end_group2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_particle_end_group2!(pv::ParticleVector, pia, cell, species)</code></pre><p>Delete particle with index <code>pia.indexer[cell, species].end2</code><code>of species</code>species<code>in cell</code>cell<code>and update the particle indexers and buffers accordingly (i.e. delete the last particle in the 2nd group of the particles of a given species in a given cell). This also sets the weight of the deleted particle to 0. If no particles are present in the 2nd group of particles, the function does nothing. This does not set the value of the</code>contiguous<code>field of</code>pia<code>to</code>false<code>even if</code>pia` becomes discontinuous; this has to be done outside of this function.</p><p><strong>Positional arguments</strong></p><ul><li><code>pv</code>: <code>ParticleVector</code> instance</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the cell in which the particle is deleted</li><li><code>species</code>: the index of the species of which the particle is deleted</li></ul></div></section></article><h2 id="Loading-species-and-interaction-data"><a class="docs-heading-anchor" href="#Loading-species-and-interaction-data">Loading species and interaction data</a><a id="Loading-species-and-interaction-data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-species-and-interaction-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_mu_ref" href="#Merzbild.compute_mu_ref"><code>Merzbild.compute_mu_ref</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mu_ref(m_r, vhs_o, vhs_Tref, vhs_d)</code></pre><p>Compute reference viscosity for the VHS model.</p><p><strong>Positional arguments</strong></p><ul><li><code>m_r</code>: collision-reduced mass</li><li><code>vhs_o</code>: exponent for the VHS potential</li><li><code>vhs_Tref</code>: reference temperature for the VHS potential</li><li><code>vhs_d</code>: diameter for the VHS potential</li></ul><p><strong>Returns</strong></p><ul><li>reference viscosity</li></ul></div></section></article><h2 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.UnitDVGrid" href="#Merzbild.UnitDVGrid"><code>Merzbild.UnitDVGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UnitDVGrid</code></pre><p>Stores information about a uniform discrete 3-dimensional velocity grid with extent <span>$[-1.0,1.0]\times[-1.0,1.0]\times[-1.0,1.0]$</span>.</p><p><strong>Fields</strong></p><ul><li><code>nx</code>: number of cells in x direction</li><li><code>ny</code>: number of cells in y direction</li><li><code>nz</code>: number of cells in z direction</li><li><code>dx</code>: grid spacing in x direction</li><li><code>dy</code>: grid spacing in y direction</li><li><code>dz</code>: grid spacing in z direction</li><li><code>vx_grid</code>: <code>Vector</code> of grid nodes in x direction</li><li><code>vy_grid</code>: <code>Vector</code> of grid nodes in y direction</li><li><code>vz_grid</code>: <code>Vector</code> of grid nodes in z direction</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.DVGrid" href="#Merzbild.DVGrid"><code>Merzbild.DVGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DVGrid</code></pre><p>Stores information about a uniform discrete 3-dimensional velocity grid with extent <span>$[-v_{x,max},v_{x,max}]\times[-v_{y,max},v_{y,max}]\times[-v_{z,max},v_{z,max}]$</span>.</p><p><strong>Fields</strong></p><ul><li><code>base_grid</code>: the underlying unit (non-scaled) <code>UnitDVGrid</code> uniform grid </li><li><code>vx_max</code>: extent of the grid in the x direction</li><li><code>vy_max</code>: extent of the grid in the y direction</li><li><code>vz_max</code>: extent of the grid in the z direction</li><li><code>dy</code>: grid spacing in x direction</li><li><code>dy</code>: grid spacing in y direction</li><li><code>dz</code>: grid spacing in z direction</li><li><code>vx_grid</code>: <code>Vector</code> of grid nodes in x direction</li><li><code>vy_grid</code>: <code>Vector</code> of grid nodes in y direction</li><li><code>vz_grid</code>: <code>Vector</code> of grid nodes in z direction</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.VDF" href="#Merzbild.VDF"><code>Merzbild.VDF</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VDF</code></pre><p>Stores the values of a function evaluated on 3-dimensional velocity grid.</p><p><strong>Fields</strong></p><ul><li><code>nx</code>: the number of grid elements in the x direction</li><li><code>ny</code>: the number of grid elements in the y direction</li><li><code>nz</code>: the number of grid elements in the z direction</li><li><code>w</code>: the 3-dimensional array of values</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.create_unit_dvgrid" href="#Merzbild.create_unit_dvgrid"><code>Merzbild.create_unit_dvgrid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>generate a grid with extent [-1.0,1.0]x[-1.0,1.0]x[-1.0,1.0]</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.create_noiseless_dvgrid" href="#Merzbild.create_noiseless_dvgrid"><code>Merzbild.create_noiseless_dvgrid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>generate a grid [-vx<em>max, vx</em>max]x[-vy<em>max, vy</em>max]x[-vz<em>max, vz</em>max]</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.create_vdf" href="#Merzbild.create_vdf"><code>Merzbild.create_vdf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>create an empty VDF of size nx * ny * nz</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sample_bkw!" href="#Merzbild.sample_bkw!"><code>Merzbild.sample_bkw!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_bkw!(rng, particles, nparticles, offset, m, T, v0)</code></pre><p>Sample particle velocities from the BKW distribution with temperature <code>T</code> for a species with mass <code>m</code> at <code>t=0</code> and add a velocity offset. Note: This does not update the particle weights, positions, or any indexing structures.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>particles</code>: the <code>Vector</code>-like structure holding the particles</li><li><code>nparticles</code>: the number of particles to sample</li><li><code>offset</code>: offset the starting position for writing the sampled particles to the <code>particles</code> array </li><li><code>m</code>: species&#39; mass</li><li><code>T</code>: temperature</li><li><code>v0</code>: the 3-dimensional velocity to add to the sampled velocities</li></ul></div></section><section><div><pre><code class="language-julia hljs">sample_bkw!(rng, particles, nparticles, m, T, v0)</code></pre><p>Sample particles&#39; velocities from the BKW distribution with temperature <code>T</code> for a species with mass <code>m</code>     at <code>t=0</code> and add a velocity offset. This does not update the particle weights, positions, or any indexing structures.     The sampled particles are written to the start of the <code>particles</code> array.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>particles</code>: the <code>Vector</code>-like structure holding the particles</li><li><code>nparticles</code>: the number of particles to sample</li><li><code>m</code>: species&#39; mass</li><li><code>T</code>: temperature</li><li><code>v0</code>: the 3-dimensional velocity to add to the sampled velocities</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.evaluate_distribution_on_grid!" href="#Merzbild.evaluate_distribution_on_grid!"><code>Merzbild.evaluate_distribution_on_grid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_distribution_on_grid!(vdf, distribution_function, grid, w_total, cutoff_v; normalize=true)</code></pre><p>Evaluate a distribution on a discrete velocity grid, considering only points inside a sphere of a given radius (the value of the VDF at points outside of the sphere will be 0.0). The values can be re-normalized so that the distribution has the prescribed computational weight/density.</p><p><strong>Positional arguments</strong></p><ul><li><code>vdf</code>: The <code>VDF</code> instance where the evaluated values will be stored</li><li><code>distribution_function</code>: the distribution function to be evaluated which takes the x, y, and z velocities as parameters</li><li><code>grid</code>: the <code>DVGrid</code> on which the distribution function is evaluated</li><li><code>w_total</code>: the total weight used in the re-normalization</li><li><code>cutoff_v</code>: the radius of the sphere used to cut off high velocities: on grid points outside the sphere   the VDF will be 0</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>normalize</code>: if <code>true</code>, the resulting values of the VDF will be renormalized so that their sum is equal to   <code>w_total</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sample_maxwellian_single!" href="#Merzbild.sample_maxwellian_single!"><code>Merzbild.sample_maxwellian_single!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_maxwellian_single!(rng, v, m, T, v0)</code></pre><p>Sample a single particle from a Maxwellian distribution with temperature T for a species with mass m     and add a velocity offset.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: The random number generator</li><li><code>v</code>: the 3-dimensional vector to store the sampled velocity</li><li><code>m</code>: the molecular mass of the species</li><li><code>T</code>: the temperature</li><li><code>v_offset</code>: the offset velocity vector to be added to the sampled velocity</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sample_maxwellian!" href="#Merzbild.sample_maxwellian!"><code>Merzbild.sample_maxwellian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_maxwellian!(rng, particles, nparticles, offset, m, T, v0)</code></pre><p>Sample <code>nparticles</code> particles from a Maxwellian with temperature T for a species with mass m and add a velocity offset. Note: This does not update the particle weights, positions, or any indexing structures.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>particles</code>: the <code>Vector</code>-like structure holding the particles</li><li><code>nparticles</code>: the number of particles to sample</li><li><code>offset</code>: offset the starting position for writing the sampled particles to the <code>particles</code> array </li><li><code>m</code>: species&#39; mass</li><li><code>T</code>: temperature</li><li><code>v0</code>: the 3-dimensional velocity to add to the sampled velocities</li></ul></div></section><section><div><pre><code class="language-julia hljs">sample_maxwellian!(rng, particles, nparticles, m, T, v0)</code></pre><p>Sample <code>nparticles</code> particles from a Maxwellian with temperature T for a species with mass m and add a velocity offset. Note: This does not update the particle weights, positions, or any indexing structures. The sampled particles are written to the start of the <code>particles</code> array.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>particles</code>: the <code>Vector</code>-like structure holding the particles</li><li><code>nparticles</code>: the number of particles to sample</li><li><code>m</code>: species&#39; mass</li><li><code>T</code>: temperature</li><li><code>v0</code>: the 3-dimensional velocity to add to the sampled velocities</li></ul></div></section></article><h2 id="Collision-computations"><a class="docs-heading-anchor" href="#Collision-computations">Collision computations</a><a id="Collision-computations-1"></a><a class="docs-heading-anchor-permalink" href="#Collision-computations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_n_coll_single_species" href="#Merzbild.compute_n_coll_single_species"><code>Merzbild.compute_n_coll_single_species</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_n_coll_single_species(rng, collision_factors, np, Δt, V)</code></pre><p>Compute the non-integer number of collisions between particles of same species.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>collision_factors</code>: the <code>CollisionFactors</code> holding the estimate of <span>$(\sigma g w)_{max}$</span>   for the species in question in the cell</li><li><code>np</code>: number of particles in the cell</li><li><code>Δt</code>: timestep</li><li><code>V</code>: cell volume</li></ul><p><strong>Returns</strong></p><p>The non-integer number of collisions.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_n_coll_two_species" href="#Merzbild.compute_n_coll_two_species"><code>Merzbild.compute_n_coll_two_species</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_n_coll_two_species(rng, collision_factors, np1, np2, Δt, V)</code></pre><p>Compute number of collisions between particles of different species</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>collision_factors</code>: the <code>CollisionFactors</code> holding the estimate of <span>$(\sigma g w)_{max}$</span>   for the species in question in the cell</li><li><code>np1</code>: number of particles of the first species in the cell</li><li><code>np2</code>: number of particles of the second species in the cell</li><li><code>Δt</code>: timestep</li><li><code>V</code>: cell volume</li></ul><p><strong>Returns</strong></p><p>The non-integer number of collisions.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_vhs_factor" href="#Merzbild.compute_vhs_factor"><code>Merzbild.compute_vhs_factor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_vhs_factor(vhs_Tref, vhs_d, vhs_o, m_r)</code></pre><p>Compute interaction-specific factor <span>$\pi D_{VHS}^2 (2 T_{ref,VHS}/m_r)^{(\omega_{VHS} - 0.5)} \frac{1}{\Gamma(2.5 - \omega_{VHS})}$</span>.</p><p><strong>Positional arguments</strong></p><ul><li><code>vhs_Tref</code>: reference temperature for the VHS potential</li><li><code>vhs_d</code>: diameter for the VHS potential</li><li><code>vhs_o</code>: exponent for the VHS potential</li><li><code>m_r</code>: collision-reduced mass</li></ul><p><strong>Returns</strong></p><ul><li>computed VHS cross-section factor</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_com!" href="#Merzbild.compute_com!"><code>Merzbild.compute_com!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_com!(collision_data::CollisionData, interaction::Interaction, p1, p2)</code></pre><p>Compute center of mass velocity of two particles.</p><p><strong>Positional arguments</strong></p><ul><li><code>collision_data</code>: the <code>CollisionData</code> instance where the computed velocity will be stored</li><li><code>interaction</code>: the <code>Interaction</code> instance for the species of the colliding particles</li><li><code>p1</code>: the first particle</li><li><code>p2</code>: the second particle</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_g!" href="#Merzbild.compute_g!"><code>Merzbild.compute_g!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_g!(collision_data::CollisionData, p1, p2)</code></pre><p>Compute relative velocity (vector and its magnitude) of two particles.</p><p><strong>Positional arguments</strong></p><ul><li><code>collision_data</code>: the <code>CollisionData</code> instance where the computed velocity will be stored</li><li><code>p1</code>: the first particle</li><li><code>p2</code>: the second particle</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_g_new_ionization!" href="#Merzbild.compute_g_new_ionization!"><code>Merzbild.compute_g_new_ionization!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_g_new_ionization!(collision_data, interaction, E_i, energy_splitting)</code></pre><p>Compute post-ionization magnitudes of the relative velocities of the impacting and newly created electrons.</p><p><strong>Positional arguments</strong></p><ul><li><code>collision_data</code>: the <code>CollisionData</code> instance where the computed velocity will be stored</li><li><code>interaction</code>: the <code>Interaction</code> instance for the electron-neutral interaction which produced the ion</li><li><code>E_i</code>: ionization energy of the neutral species in electron-volt</li><li><code>energy_splitting</code>: how the energy is divided among the electrons: if <code>ElectronEnergySplitEqual</code>, the energy is split equally,   if <code>ElectronEnergySplitZeroE</code>, one electron takes all of the energy</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scatter_vhs!" href="#Merzbild.scatter_vhs!"><code>Merzbild.scatter_vhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scatter_vhs!(rng, collision_data, interaction, p1, p2)</code></pre><p>Scatter two particles using VHS (isotropic) scattering.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>collision_data</code>: the <code>CollisionData</code> instance to which stores the   center-of-mass velocity, the magnitude of the pre-collisional relative velocity of the particles and to which   the new post-collisional velocity will be written</li><li><code>interaction</code>: the <code>Interaction</code> instance for the colliding particles</li><li><code>p1</code>: the first colliding particle</li><li><code>p2</code>: the second colliding particle</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scatter_electron_vhs!" href="#Merzbild.scatter_electron_vhs!"><code>Merzbild.scatter_electron_vhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scatter_electron_vhs!(rng, collision_data, particles_electron, g_new)</code></pre><p>Scatter an electron off of a neutral particle using VHS (isotropic) scattering and re-scale its relative velocity to <code>g_new</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>collision_data</code>: the <code>CollisionData</code> instance to which stores the   center-of-mass velocity and the magnitude of the pre-collisional relative velocity   of the electron and the neutral</li><li><code>particles_electron</code>: the electron particle to scatter off of the neutral particle</li><li><code>g_new</code>: the magnitude of the post-collisional relative velocity</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scatter_ionization_electrons!" href="#Merzbild.scatter_ionization_electrons!"><code>Merzbild.scatter_ionization_electrons!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scatter_ionization_electrons!(rng, collision_data, particles_electron, i1, i2)</code></pre><p>Scatter two electrons off of a neutral using VHS (isotropic) scattering.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>collision_data</code>: the <code>CollisionData</code> instance to which stores the   center-of-mass velocity the magnitude of the pre-collisional relative velocity   of the electron and the neutral, and the post-collisional magnitudes of the velocities   of the electrons</li><li><code>particles_electron</code>: the vector of electron particles to scatter off of the neutral particle</li><li><code>i1</code>: the index of the first electron particle to scatter off of the neutral</li><li><code>i2</code>: the index of the second electron particle to scatter off of the neutral</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sigma_vhs" href="#Merzbild.sigma_vhs"><code>Merzbild.sigma_vhs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sigma_vhs(interaction, g)</code></pre><p>Computes the VHS cross-section.</p><p><strong>Positional arguments</strong></p><ul><li><code>interaction</code>: the <code>Interaction</code> instance</li><li><code>g</code>: the relative velocity of the collision</li></ul><p><strong>Returns</strong></p><p>The value of the computed cross-section.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_tabulated_cs_constant_continuation" href="#Merzbild.compute_tabulated_cs_constant_continuation"><code>Merzbild.compute_tabulated_cs_constant_continuation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_tabulated_cs_constant_continuation(tabulated_cs_data, E_coll)</code></pre><p>Compute an energy-dependent cross-section from tabulated data using linear interpolation. If the energy is smaller than the minimum energy used for the tabulation, return first element of the table; if energy is larger than the maximum energy used for the tabulation, return last element of the table.</p><p><strong>Positional arguments</strong></p><ul><li><code>tabulated_cs_data</code>: a <code>TabulatedCSData</code> instance with the tabulated energies and cross-section values</li><li><code>E_coll</code>: the collision energy for which to compute the cross-section</li></ul><p><strong>Returns</strong></p><p>The value of the cross-section.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_tabulated_cs_zero_continuation" href="#Merzbild.compute_tabulated_cs_zero_continuation"><code>Merzbild.compute_tabulated_cs_zero_continuation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_tabulated_cs_zero_continuation(tabulated_cs_data, E_coll)</code></pre><p>Compute an energy-dependent cross-section from tabulated data using linear interpolation. If the energy is outside of the range of energies used for the tabulation, returns 0.0.</p><p><strong>Positional arguments</strong></p><ul><li><code>tabulated_cs_data</code>: a <code>TabulatedCSData</code> instance with the tabulated energies and cross-section values</li><li><code>E_coll</code>: the collision energy for which to compute the cross-section</li></ul><p><strong>Returns</strong></p><p>The value of the cross-section.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_cross_sections_only!" href="#Merzbild.compute_cross_sections_only!"><code>Merzbild.compute_cross_sections_only!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_cross_sections_only!(computed_cs, interaction, g, electron_neutral_interactions, neutral_species_index)</code></pre><p>Compute electron-impact ionization and excitation cross-sections, and electron-neutral elastic scattering crosss-sections, and return collision energy in eV. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances in which the computed values will be stored</li><li><code>interaction</code>: the <code>Interaction</code> instance describing the electron-neutral interaction being considered</li><li><code>g</code>: the magnitude of the relative collision velocity</li><li><code>electron_neutral_interactions</code>: the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The electron-neutral collision energy in eV.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_cross_sections!" href="#Merzbild.compute_cross_sections!"><code>Merzbild.compute_cross_sections!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_cross_sections!(computed_cs, interaction, g, electron_neutral_interactions, neutral_species_index)</code></pre><p>Compute electron-impact ionization and excitation cross-sections, electron-neutral elastic scattering cross-sections, total collision cross-section, probabilities of the different processes, and return collision energy in eV. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances in which the computed values will be stored</li><li><code>interaction</code>: the <code>Interaction</code> instance describing the electron-neutral interaction being considered</li><li><code>g</code>: the magnitude of the relative collision velocity</li><li><code>electron_neutral_interactions</code>: the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The electron-neutral collision energy in eV.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cs_total" href="#Merzbild.get_cs_total"><code>Merzbild.get_cs_total</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cs_total(electron_neutral_interactions, computed_cs, neutral_species_index)</code></pre><p>Get the value of a computed total collision cross-section for electron-neutral interactions. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>electron_neutral_interactions</code>: the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances holding the computed cross-section values</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The value of the total collision cross-section.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cs_elastic" href="#Merzbild.get_cs_elastic"><code>Merzbild.get_cs_elastic</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cs_elastic(electron_neutral_interactions, computed_cs, neutral_species_index)</code></pre><p>Get the value of a computed electron-neutral elastic scattering cross-section. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>electron_neutral_interactions</code>: the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances holding the computed cross-section values</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The value of the elastic scattering cross-section.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cs_ionization" href="#Merzbild.get_cs_ionization"><code>Merzbild.get_cs_ionization</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cs_ionization(electron_neutral_interactions, computed_cs, neutral_species_index)</code></pre><p>Get the value of a computed electron-impact ionization cross-section. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>electron_neutral_interactions</code>: the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances holding the computed cross-section values</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The value of the electron-impact ionization scattering cross-section.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_ionization_threshold" href="#Merzbild.get_ionization_threshold"><code>Merzbild.get_ionization_threshold</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ionization_threshold(electron_neutral_interactions, neutral_species_index)</code></pre><p>Get the ionization threshold energy. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>electron_neutral_interactions</code> the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The ionization threshold energy of a specific neutral species.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_electron_energy_split" href="#Merzbild.get_electron_energy_split"><code>Merzbild.get_electron_energy_split</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_electron_energy_split(electron_neutral_interactions, neutral_species_index)</code></pre><p>Get the way electron energy is split during ionization for a specific electron-neutral interaction. Here <code>neutral_species_index</code> is the index of the neutral species being considered in the overall array of the <code>Species</code> instances that includes all species in the simulation and was used to construct the <code>ElectronNeutralInteractions</code> instance.</p><p><strong>Positional arguments</strong></p><ul><li><code>electron_neutral_interactions</code> the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data</li><li><code>neutral_species_index</code>: the index of the neutral species being considered</li></ul><p><strong>Returns</strong></p><p>The <code>ElectronEnergySplit</code> value for the specific electron-neutral interaction.</p></div></section></article><h2 id="Electron-neutral-interactions"><a class="docs-heading-anchor" href="#Electron-neutral-interactions">Electron-neutral interactions</a><a id="Electron-neutral-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Electron-neutral-interactions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.TabulatedCSData" href="#Merzbild.TabulatedCSData"><code>Merzbild.TabulatedCSData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TabulatedCSData</code></pre><p>Structure for storing tabulated cross-section data as a function of relative collision energy</p><p><strong>Fields</strong></p><ul><li><code>n_vals</code>: number of values stored</li><li><code>E</code>: array of relative collision energies</li><li><code>sigma</code>: array of cross-section values at these energies</li><li><code>ΔE</code>: how much energy is lost (gained) in the collision in case it is inelastic</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.ElasticScattering" href="#Merzbild.ElasticScattering"><code>Merzbild.ElasticScattering</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ElasticScattering</code></pre><p>Structure to hold data on an elastic scattering cross-section.</p><p><strong>Fields</strong></p><ul><li><code>data</code>: a <code>TabulatedCSData</code> instance holding the cross-section values</li><li><code>scattering</code>: the <code>ScatteringLaw</code> model for the scattering of the particles</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.ExcitationSink" href="#Merzbild.ExcitationSink"><code>Merzbild.ExcitationSink</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Ionization</code></pre><p>Structure to hold data on electron-impact electronic excitation cross-sections for a specific species.</p><p><strong>Fields</strong></p><ul><li><code>n_reactions</code>: number of electron-impact electronic excitation reactions</li><li><code>data</code>: an array of <code>TabulatedCSData</code> instances (of length <code>n_reactions</code>) holding the cross-section values for each reaction</li><li><code>scattering</code>: the <code>ScatteringLaw</code> model for the scattering of the particles</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.Ionization" href="#Merzbild.Ionization"><code>Merzbild.Ionization</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Ionization</code></pre><p>Structure to hold data on an electron-impact ionization cross-section.</p><p><strong>Fields</strong></p><ul><li><code>data</code>: a <code>TabulatedCSData</code> instance holding the cross-section values</li><li><code>scattering</code>: the <code>ScatteringLaw</code> model for the scattering of the electrons</li><li><code>split</code>: the <code>ElectronEnergySplit</code> model for energy splitting across the primary and secondary electrons</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.find_species_in_db" href="#Merzbild.find_species_in_db"><code>Merzbild.find_species_in_db</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find a chemical species in an LXCat-format XML; returns the first instance of the species found and the id of the &quot;Groups&quot; element in which the species was found. The following conditions need to be satisfied for a tuple <code>(i,j)</code> for it to be returned: <code>tag(xml_data[i]) == &quot;Groups&quot;</code> and <code>attributes(xml_data[i][j])[&quot;id&quot;] == species_name</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>xml_data</code>: the LXCat-format XML data to be searched</li><li><code>species_name</code>: the name of the species to search for</li></ul><p><strong>Returns</strong></p><p>Tuple <code>(i,j)</code> denoting the index of the group and group element in which the species is located</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.load_elastic_data" href="#Merzbild.load_elastic_data"><code>Merzbild.load_elastic_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_elastic_data(xml_data)</code></pre><p>Load electron-neutral elastic scattering data from the part of an LXCat-format XML file for a specific species. The following should hold for the data to be loaded: <code>tag(xml_data[i]) == &quot;Processes&quot;</code>, <code>attributes(xml_data[i][j])[&quot;type&quot;] == &quot;Ionization&quot;</code>. This will load the first set of data found for the ionization process.</p><p><strong>Positional arguments</strong></p><ul><li><code>xml_data</code>: the LXCat-format XML data to be searched</li></ul><p><strong>Returns</strong></p><p><code>TabulatedCSData</code> structure containing the electron-neutral elastic scattering cross-section data.</p><p><strong>Throws</strong></p><p><code>DataMissingException</code> if data not found or not all required data present.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.load_ionization_data" href="#Merzbild.load_ionization_data"><code>Merzbild.load_ionization_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ionization_data(xml_data)</code></pre><p>Load electron-impact ionization data from the part of an LXCat-format XML file for a specific species. The following should hold for the data to be loaded: <code>tag(xml_data[i]) == &quot;Processes&quot;</code>, <code>attributes(xml_data[i][j])[&quot;type&quot;] == &quot;Ionization&quot;</code>. This will load the first set of data found for the ionization process.</p><p><strong>Positional arguments</strong></p><ul><li><code>xml_data</code>: the LXCat-format XML data to be searched</li></ul><p><strong>Returns</strong></p><p><code>TabulatedCSData</code> structure containing the electron-impact ionization cross-section data.</p><p><strong>Throws</strong></p><p><code>DataMissingException</code> if data not found or not all required data present.</p></div></section></article><h2 id="Merging"><a class="docs-heading-anchor" href="#Merging">Merging</a><a id="Merging-1"></a><a class="docs-heading-anchor-permalink" href="#Merging" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.GridCell" href="#Merzbild.GridCell"><code>Merzbild.GridCell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GridCell</code></pre><p>Struct for keeping track of merging-related quantities in a velocity grid cell.</p><p><strong>Fields</strong></p><ul><li><code>np</code>: number of particles in cell</li><li><code>w</code>: total computational weight of particles  in cell</li><li><code>v_mean</code>: mean velocity of particles in cell</li><li><code>v_std_sq</code>: variance of velocity of particles in cell</li><li><code>x_mean</code>: mean position of particles in cell</li><li><code>x_std_sq</code>: variance of position of particles in cell</li><li><code>particle_index1</code>: index of first particle in the cell (first as in the first particle that is found to   belong to the cell)</li><li><code>particle_index1</code>: index of second particle in the cell (second as in the second particle that is found to   belong to the cell)</li><li><code>w1</code>: the post-merge weight to assign to the first particle in the cell</li><li><code>w2</code>: the post-merge weight to assign to the second particle in the cell</li><li><code>v1</code>: the post-merge velocity to assign to the first particle in the cell</li><li><code>v2</code>: the post-merge velocity to assign to the second particle in the cell</li><li><code>x1</code>: the post-merge position to assign to the first particle in the cell</li><li><code>x2</code>: the post-merge position to assign to the second particle in the cell</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_velocity_extent!" href="#Merzbild.compute_velocity_extent!"><code>Merzbild.compute_velocity_extent!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_velocity_extent!(merging_grid, cell, species, species_data, phys_props)</code></pre><p>Compute extent of velocity grid based on temperature in the cell.</p><p><strong>Positional arguments:</strong></p><ul><li><code>merging_grid</code>: the grid merging (<code>GridN2Merge</code>) instance for which to compute the extent</li><li><code>cell</code>: the index of the cell in which the temperature was computed</li><li><code>species</code>: the index of the species for which the temperature was computed</li><li><code>species_data</code>: the array of <code>Species</code> data</li><li><code>phys_props</code>: the <code>PhysProps</code> instance containing the computed temperature</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_grid_index" href="#Merzbild.compute_grid_index"><code>Merzbild.compute_grid_index</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_grid_index(merging_grid, v)</code></pre><p>Compute index of cell on the merging grid in which a velocity is located (the last 8 indices correspond to the velocity octants outside the grid).</p><p><strong>Positional arguments:</strong></p><ul><li><code>merging_grid</code>: the grid merging (<code>GridN2Merge</code>) instance defining the velocity space grid</li><li><code>v</code>: the velocity vector</li></ul><p><strong>Returns:</strong></p><p>Index of cell on the merging grid.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.clear_merging_grid!" href="#Merzbild.clear_merging_grid!"><code>Merzbild.clear_merging_grid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clear_merging_grid!(merging_grid)</code></pre><p>Resets all data for a merging grid instance.</p><p><strong>Positional arguments:</strong></p><ul><li><code>merging_grid</code>: the grid merging (<code>GridN2Merge</code>) instance defining the velocity space grid</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_grid!" href="#Merzbild.compute_grid!"><code>Merzbild.compute_grid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_grid!(merging_grid::GridN2Merge, particles, pia, cell, species)</code></pre><p>Compute all the required cell properties for a grid-based merge.</p><p><strong>Positional arguments:</strong></p><ul><li><code>merging_grid</code>: the grid merging (<code>GridN2Merge</code>) instance defining the velocity space grid</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the cell index</li><li><code>species</code>: the species index</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_new_particles!" href="#Merzbild.compute_new_particles!"><code>Merzbild.compute_new_particles!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_new_particles!(rng, merging_grid::GridN2Merge, particles, pia, cell, species)</code></pre><p>Compute new particles based on the grid cell properties without checking particle locations. So particles may end up outside of the domain.</p><p><strong>Positional arguments:</strong></p><ul><li><code>rng</code>: the random number generator instance</li><li><code>merging_grid</code>: the grid merging (<code>GridN2Merge</code>) instance defining the velocity space grid</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the cell index</li><li><code>species</code>: the species index</li></ul></div></section><section><div><pre><code class="language-julia hljs">compute_new_particles!(rng, octree::OctreeN2Merge, particles, pia, cell, species)</code></pre><p>Compute post-merge particles particles based on octree bin properties without checking particle locations. So particles may end up outside of the domain.</p><p><strong>Positional arguments:</strong></p><ul><li><code>rng</code>: the random number generator instance</li><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the cell index</li><li><code>species</code>: the species index</li></ul></div></section><section><div><pre><code class="language-julia hljs">compute_new_particles!(rng, octree::OctreeN2Merge, particles, pia, cell, species, grid)</code></pre><p>Compute post-merge particles particles based on octree bin properties; placing out-of-domain particles back into the domain.</p><p><strong>Positional arguments:</strong></p><ul><li><code>rng</code>: the random number generator instance</li><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the cell index</li><li><code>species</code>: the species index</li><li><code>grid</code>: the <code>Grid1DUniform</code> grid</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.vx_sign" href="#Merzbild.vx_sign"><code>Merzbild.vx_sign</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vx_sign(octant)</code></pre><p>Return sign of velocity vx of an octant in velocity space.</p><p><strong>Positional arguments</strong></p><ul><li><code>octant</code>: index of the octant in velocity space</li></ul><p><strong>Returns</strong></p><p>Sign of the x-velocity corresponding to the octant.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.vy_sign" href="#Merzbild.vy_sign"><code>Merzbild.vy_sign</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vy_sign(octant)</code></pre><p>Return sign of velocity vy of an octant in velocity space.</p><p><strong>Positional arguments</strong></p><ul><li><code>octant</code>: index of the octant in velocity space</li></ul><p><strong>Returns</strong></p><p>Sign of the y-velocity corresponding to the octant.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.vz_sign" href="#Merzbild.vz_sign"><code>Merzbild.vz_sign</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vz_sign(octant)</code></pre><p>Return sign of velocity <code>vz</code> of an octant in velocity space.</p><p><strong>Positional arguments</strong></p><ul><li><code>octant</code>: index of the octant in velocity space</li></ul><p><strong>Returns</strong></p><p>Sign of the z-velocity corresponding to the octant</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.check_speed_bound" href="#Merzbild.check_speed_bound"><code>Merzbild.check_speed_bound</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_speed_bound(speed_val, minval, maxval)</code></pre><p>Compare <code>speed_val</code> to the bounds and return either the value if its within bounds or the appropriate closest bound.</p><p><strong>Positional arguments</strong></p><ul><li><code>speed_val</code>: value to check</li><li><code>minval</code>: lower bound</li><li><code>maxval</code>: upper bound</li></ul><p><strong>Returns</strong></p><p>Either original value or value of closest bound.</p></div></section><section><div><pre><code class="language-julia hljs">check_speed_bound(speed_val, minval, maxval, multiplier)</code></pre><p>Compare <code>speed_val</code> time a multiplier to the bounds and return either the value times the multiplier if its within bounds or the appropriate closest bound times the multiplier.</p><p><strong>Positional arguments</strong></p><ul><li><code>speed_val</code>: value to check</li><li><code>minval</code>: lower bound</li><li><code>maxval</code>: upper bound</li><li><code>multiplier</code>: the multiplier</li></ul><p><strong>Returns</strong></p><p>Either original value times the multiplier or value of closest bound times the multiplier.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.base_multi_index_moments" href="#Merzbild.base_multi_index_moments"><code>Merzbild.base_multi_index_moments</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">base_multi_index_moments()</code></pre><p>Base multi indices corresponding to conservation of mass, momentum, and energy components.</p><p><strong>Positional arguments</strong></p><p>None</p><p><strong>Returns</strong></p><p>A vector of multi-indices (3-tuples) which corresponding to mass, momentum, and directional energy.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_w_total_v0!" href="#Merzbild.compute_w_total_v0!"><code>Merzbild.compute_w_total_v0!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_w_total_v0!(nnls_merging, particles, pia, cell, species)</code></pre><p>Compute total computational weight of particles and mean velocity, as well as velocity bounds of the set of particles in each velocity direction.</p><p><strong>Positional arguments</strong></p><ul><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance where the computed values will be stored</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles that are being merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.ccm" href="#Merzbild.ccm"><code>Merzbild.ccm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ccm(v, v0, mim)</code></pre><p>Compute unweighted central moment.</p><p><strong>Positional arguments</strong></p><ul><li><code>v</code>: the 3-dimensional velocity vector</li><li><code>v0</code>: the 3-dimensional mean velocity vector</li><li><code>mim</code>: the 3-dimensional multi-index</li></ul><p><strong>Returns</strong></p><p>Computed unweighted central moment.</p></div></section><section><div><pre><code class="language-julia hljs">ccm(vx, vy, vz, vx0, vy0, vz0, mim)</code></pre><p>Compute unweighted central moment.</p><p><strong>Positional arguments</strong></p><ul><li><code>vx</code>: the x component of the velocity</li><li><code>vy</code>: the y component of the velocity</li><li><code>vz</code>: the z component of the velocity</li><li><code>vx0</code>: the x component of the mean velocity</li><li><code>vy0</code>: the y component of the mean velocity</li><li><code>vz0</code>: the z component of the mean velocity</li><li><code>mim</code>: the 3-dimensional multi-index</li></ul><p><strong>Returns</strong></p><p>Computed unweighted central moment.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_and_rhs!" href="#Merzbild.compute_lhs_and_rhs!"><code>Merzbild.compute_lhs_and_rhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_lhs_and_rhs!(nnls_merging, lhs_matrix, particles, pia, cell, species)</code></pre><p>Compute LHS matrix and RHS vector for NNLS merging. Returns the pre-merge number of particles.</p><p><strong>Positional arguments</strong></p><ul><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance where the RHS vector will be stored</li><li><code>lhs_matrix</code>: the matrix of size <code>n_total_conserved x n_particles</code>, where   <code>n_total_conserved</code> is the number of conserved moments and <code>n_particles</code> is the pre-merge number of particles</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles that are being merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li></ul><p><strong>Returns</strong></p><p>The pre-merge number of particles.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_and_rhs_rate_preserving!" href="#Merzbild.compute_lhs_and_rhs_rate_preserving!"><code>Merzbild.compute_lhs_and_rhs_rate_preserving!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_lhs_and_rhs_rate_preserving!(nnls_merging, lhs_matrix, particles, pia, cell, species)</code></pre><p>Compute LHS matrix and RHS vector for the rate-preserving NNLS merging (for electrons). Approximate     elastic scattering and electron-impact ionization rates are conserved.</p><p><strong>Positional arguments</strong></p><ul><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance where the RHS vector will be stored</li><li><code>lhs_matrix</code>: the matrix of size <code>n_total_conserved x n_particles</code>, where   <code>n_total_conserved</code> is the number of conserved moments and <code>n_particles</code> is the pre-merge number of particles</li><li><code>interaction</code>: the <code>Interaction</code> instance describing the electron-neutral interaction being considered</li><li><code>electron_neutral_interactions</code>:  the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data used to compute the rates</li><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances in which the computed values will be stored</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles that are being merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li><li><code>neutral_species_index</code>: the index of the neutral species which is the collision partner in the electron-neutral   collisions for which approximate rates are being preserved.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_particles_additional!" href="#Merzbild.compute_lhs_particles_additional!"><code>Merzbild.compute_lhs_particles_additional!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_lhs_particles_additional!(rng, col_index, nnls_merging, lhs_matrix,
                                       particles, pia, cell, species,
                                       n_rand_pairs)</code></pre><p>Compute additional LHS columns for additional particles. One particle is added at the local zero velocity ( i.e. mean velocity of the whole system of particles), 8 particles are added (1 per velocity space octant) using the standard deviation of the velocities of the whole particle system in each direction to determine their velocities (+ bounded via use of the <a href="#Merzbild.check_speed_bound"><code>check_speed_bound</code></a> function). A second set of 8 particles is added using a similar scheme, but the velocities are multiplied by 0.5. Finally, <code>n_rand_pairs</code> particle pairs are chosen and their mean velocities are used to compute these additional particles.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator instance</li><li><code>col_index</code>: the index of the first column where to start writing the additionally computed values</li><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance where the RHS vector will be stored</li><li><code>lhs_matrix</code>: the matrix of size <code>n_total_conserved x n_particles</code>, where   <code>n_total_conserved</code> is the number of conserved moments and <code>n_particles</code> is the pre-merge number of particles</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles that are being merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li><li><code>n_rand_pairs</code>: the number of random particle pairs to choose</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_particles_additional_rate_preserving!" href="#Merzbild.compute_lhs_particles_additional_rate_preserving!"><code>Merzbild.compute_lhs_particles_additional_rate_preserving!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_lhs_particles_additional_rate_preserving!(rng, col_index, nnls_merging, lhs_matrix,
                                       interaction, electron_neutral_interactions, computed_cs, 
                                       particles, pia, cell, species, neutral_species_index,
                                       n_rand_pairs)</code></pre><p>Compute additional LHS columns for additional particles for the rate-preserving NNLS merging (for electrons). One particle is added at the local zero velocity (i.e. mean velocity of the whole system of particles), 8 particles are added (1 per velocity space octant) using the standard deviation of the velocities of the whole particle system in each direction to determine their velocities (+ bounded via use of the <a href="#Merzbild.check_speed_bound"><code>check_speed_bound</code></a> function). A second set of 8 particles is added using a similar scheme, but the velocities are multiplied by 0.5. Finally, <code>n_rand_pairs</code> particle pairs are chosen and their mean velocities are used to compute these additional particles.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator instance</li><li><code>col_index</code>: the index of the first column where to start writing the additionally computed values</li><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance where the RHS vector will be stored</li><li><code>lhs_matrix</code>: the matrix of size <code>n_total_conserved x n_particles</code>, where   <code>n_total_conserved</code> is the number of conserved moments and <code>n_particles</code> is the pre-merge number of particles</li><li><code>interaction</code>: the <code>Interaction</code> instance describing the electron-neutral interaction being considered</li><li><code>electron_neutral_interactions</code>:  the <code>ElectronNeutralInteractions</code> instance storing the tabulated cross-section   data used to compute the rates</li><li><code>computed_cs</code>: the vector of <code>ComputedCrossSection</code> instances in which the computed values will be stored</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles that are being merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li><li><code>neutral_species_index</code>: the index of the neutral species which is the collision partner in the electron-neutral   collisions for which approximate rates are being preserved.</li><li><code>n_rand_pairs</code>: the number of random particle pairs to choose</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scale_lhs_rhs!" href="#Merzbild.scale_lhs_rhs!"><code>Merzbild.scale_lhs_rhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale_lhs_rhs!(nnls_merging, lhs_matrix)</code></pre><p>Scale the LHS and RHS of the NNLS system using the reference velocity <span>$v_{ref}$</span>. Each moment is scaled by <span>$(1/v_{ref})^{n_{tot}}$</span>, where <span>$n_{tot}$</span> is the total order of the moment (i.e. for a moment with multi-index <code>(i,j,k)</code> the total order is <code>i+j+k</code>).</p><p><strong>Positional arguments</strong></p><ul><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance</li><li><code>lhs_matrix</code>: the matrix of the LHS</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scale_lhs_rhs_rate_preserving!" href="#Merzbild.scale_lhs_rhs_rate_preserving!"><code>Merzbild.scale_lhs_rhs_rate_preserving!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scale_lhs_rhs_rate_preserving!(nnls_merging, lhs_matrix, ref_cs_elastic, ref_cs_ion)</code></pre><p>Scale the LHS and RHS of the NNLS system for the rate-preserving electron merging using the reference velocity <span>$v_{ref}$</span> and reference elastic scattering and ionization cross-sections. Each moment is scaled by <span>$(1/v_{ref})^{n_{tot}}$</span>, where <span>$n_{tot}$</span> is the total order of the moment (i.e. for a moment with multi-index <code>(i,j,k)</code> the total order is <code>i+j+k</code>). The entries in the LHS and RHS corresponding to the rates are scaled by <span>$1/(v_{ref} * \sigma_{p})$</span>, where <span>$\sigma_{p}$</span> is the cross-section of process <span>$p$</span>. </p><p><strong>Positional arguments</strong></p><ul><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance</li><li><code>lhs_matrix</code>: the matrix of the LHS</li><li><code>ref_cs_elastic</code>: the reference elastic scattering cross-section</li><li><code>ref_cs_ion</code>: the reference ionization cross-section</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_post_merge_particles_nnls!" href="#Merzbild.compute_post_merge_particles_nnls!"><code>Merzbild.compute_post_merge_particles_nnls!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_post_merge_particles_nnls!(lhs_ncols, lhs_matrix,
                                        nnls_merging, particles, pia, cell, species)</code></pre><p>Compute post-merge particles based on the solution of the NNLS problem. This will replace the particles with the post-merge ones and delete any extraneous particles.</p><p><strong>Positional arguments</strong></p><ul><li><code>lhs_ncols</code>: the number of columns in the LHS matrix</li><li><code>lhs_matrix</code>: the LHS matrix of the NNLS system</li><li><code>nnls_merging</code>: the <code>NNLSMerge</code> instance</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles that are being merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.OctreeCell" href="#Merzbild.OctreeCell"><code>Merzbild.OctreeCell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OctreeCell</code></pre><p>Struct holding computed bin properties needed for refinement of an octree bin.</p><p><strong>Fields</strong></p><ul><li><code>np</code>: number of particles in cell</li><li><code>w</code>: total computational weight of particles in cell</li><li><code>v_min</code>: vector of the per-component lower bounds of the velocities in the cell</li><li><code>v_max</code>: vector of the per-component upper bounds of the velocities in the cell</li><li><code>depth</code>: level of refinement the cell is at</li><li><code>can_be_refined</code>: whether the cell can be refined further</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.OctreeFullCell" href="#Merzbild.OctreeFullCell"><code>Merzbild.OctreeFullCell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OctreeFullCell</code></pre><p>Struct holding computed bin properties required to merge the particles in a bin.</p><p><strong>Fields</strong></p><ul><li><code>v_mean</code>: mean velocity of particles in cell</li><li><code>v_std_sq</code>: variance of velocity of particles in cell</li><li><code>x_mean</code>: mean position of particles in cell</li><li><code>x_std_sq</code>: variance of position of particles in cell</li><li><code>particle_index1</code>: index of first particle in the cell (first as in the first particle that is found to   belong to the cell)</li><li><code>particle_index1</code>: index of second particle in the cell (second as in the second particle that is found to   belong to the cell)</li><li><code>w1</code>: the post-merge weight to assign to the first particle in the cell</li><li><code>w2</code>: the post-merge weight to assign to the second particle in the cell</li><li><code>v1</code>: the post-merge velocity to assign to the first particle in the cell</li><li><code>v2</code>: the post-merge velocity to assign to the second particle in the cell</li><li><code>x1</code>: the post-merge position to assign to the first particle in the cell</li><li><code>x2</code>: the post-merge position to assign to the second particle in the cell</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.fill_bins" href="#Merzbild.fill_bins"><code>Merzbild.fill_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill_bins(Nbins)</code></pre><p>Fill the octree bins structs with zero data, used as a utility function for initialization.</p><p>Positional arguments:</p><ul><li><code>Nbins</code>: number of <code>OctreeCell</code> bins to create</li></ul><p>Returns: An array of <code>Nbins</code> <code>OctreeCell</code> instances filled with zeros.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.fill_full_bins" href="#Merzbild.fill_full_bins"><code>Merzbild.fill_full_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill_full_bins(Nbins)</code></pre><p>Fill the octree bins full structs with zero data, used as a utility function for initialization.</p><p>Positional arguments:</p><ul><li><code>Nbins</code>: number of <code>OctreeFullCell</code> bins to create</li></ul><p>Returns: An array of <code>Nbins</code> <code>OctreeFullCell</code> instances filled with zeros.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.clear_octree!" href="#Merzbild.clear_octree!"><code>Merzbild.clear_octree!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clear_octree!(octree)</code></pre><p>Reset octree before doing a new merge.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.resize_octree_buffers!" href="#Merzbild.resize_octree_buffers!"><code>Merzbild.resize_octree_buffers!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">resize_octree_buffers!(octree, n_particles)</code></pre><p>Check and resize octree buffers if needed to accommodate a larger number of particles. The size of the buffers is set to <code>n_particles + DELTA_PARTICLES</code> if the their sizes are smaller than <code>n_particles</code>.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>n_particles</code>: the current number of particles being merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_octant" href="#Merzbild.compute_octant"><code>Merzbild.compute_octant</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_octant(particle_v, v_middle)</code></pre><p>Compute octant of particle velocity relative to a <code>v_middle</code>` The order of the octants is:</p><pre><code class="nohighlight hljs">1. - - -
2. + - -
3. - + -
4. + + -
5. - - +
6. + - +
7. - + +
8. + + +</code></pre><p><strong>Positional arguments:</strong></p><ul><li><code>particle_v</code>: the velocity of the particle</li><li><code>v_middle</code>: the velocity relative to which the octant is computed</li></ul><p><strong>Returns:</strong></p><p>The octant number</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.bin_bounds_inherit!" href="#Merzbild.bin_bounds_inherit!"><code>Merzbild.bin_bounds_inherit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bin_bounds_inherit!(octree, bin_id, v_min_parent, v_max_parent, v_middle, octant)</code></pre><p>Compute new bin bounds of one of the 8 octant sub-bins inheriting bounds of parent bin.  The order of the octants is</p><pre><code class="nohighlight hljs">1. - - -
2. + - -
3. - + -
4. + + -
5. - - +
6. + - +
7. - + +
8. + + +</code></pre><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bin_id</code>: the index of the bin for which the velocity bounds are being recomputed</li><li><code>v_min_parent</code>: the velocity vector of the lower bound of the velocities of the parent bin</li><li><code>v_max_parent</code>: the velocity vector of the upper bound of the velocities of the parent bin</li><li><code>v_middle</code>: the velocity across which the split is being performed</li><li><code>octant</code>: the octant of the parent bin to which this bin corresponds</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.bin_bounds_recompute!" href="#Merzbild.bin_bounds_recompute!"><code>Merzbild.bin_bounds_recompute!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bin_bounds_recompute!(octree, bin_id, bs, be, particles)</code></pre><p>Recompute bin bounds based on particle velocities by setting them to the smallest and largest velocities of the particles in each velocity direction.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bin_id</code>: the index of the bin for which the velocity bounds are being recomputed</li><li><code>bs</code>: index of the first particle in bin</li><li><code>be</code>: index of the last particle in bin</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_v_mean!" href="#Merzbild.compute_v_mean!"><code>Merzbild.compute_v_mean!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_v_mean!(octree, bs, be, particles)</code></pre><p>Compute mean velocity of particles in a bin.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bs</code>: index of the first particle in bin</li><li><code>be</code>: index of the last particle in bin</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_v_median!" href="#Merzbild.compute_v_median!"><code>Merzbild.compute_v_median!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_v_median!(octree, bs, be, particles)</code></pre><p>Compute median velocity of particles in a bin. NOTE: allocates memory and is probably not fully correct!</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bs</code>: index of the first particle in bin</li><li><code>be</code>: index of the last particle in bin</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_new_bin_id" href="#Merzbild.get_new_bin_id"><code>Merzbild.get_new_bin_id</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_new_bin_id(i, bin_id, Nbins)</code></pre><p>Get index of a newly created bin once a bin with index <code>bin_id</code> is split into 8 sub-bins. The <code>bin_id</code> index is re-used for the 1-st sub-bin, and the other 7 sub-bins are tacked onto the end of the list of bins (so they have indices Nbins + 1, Nbins + 2, ..., where Nbins was the total number of octree bins before the split).</p><p><strong>Positional arguments</strong></p><ul><li><code>i</code>: index of sub-octant (ranging from 1 to 8) of the split bin for which to return a new bin index</li><li><code>bin_id</code>: index of bin being split</li><li><code>Nbins</code>: total number of octree bins before the split</li></ul><p><strong>Returns</strong></p><p>Index of a newly created bin corresponding to a bin created from sub-octant <code>i</code> of bin <code>bin_id</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.split_bin!" href="#Merzbild.split_bin!"><code>Merzbild.split_bin!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_bin!(octree, bin_id, particles)</code></pre><p>Sort particles into sub-bins of a bin with index <code>bin_id</code> (by splitting it into octants), keeping track of which sub-bins particles end up in. Also sets the velocity bounds of the new bins.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bin_id</code>: octree bin index</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_bin_props!" href="#Merzbild.compute_bin_props!"><code>Merzbild.compute_bin_props!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_bin_props!(octree, bin_id, particles)</code></pre><p>Compute properties in a bin required for merging: total computational weight, mean velocity and position, standard deviation of particle velocities and positions.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bin_id</code>: octree bin index</li><li><code>particles</code>: the <code>ParticleVector</code> instance of the particles to be merged</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_bin_post_merge_np" href="#Merzbild.get_bin_post_merge_np"><code>Merzbild.get_bin_post_merge_np</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_bin_post_merge_np(octree, bin_id)</code></pre><p>Get number of post-merge particles in a bin: 2 if the number of particles in the bin is &gt;= 2, otherwise the number of particles in the bin (0 or 1) is returned.</p><p><strong>Positional arguments:</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>bin_id</code>: octree bin index</li></ul><p><strong>Returns</strong></p><p>The number of post-merge particles in a single octree bin (0, 1, or 2).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.init_octree!" href="#Merzbild.init_octree!"><code>Merzbild.init_octree!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_octree!(octree, particles, pia, cell, species)</code></pre><p>Initialize the top bin in an octree by copying particle indices and setting bin bounds.</p><p><strong>Positional arguments</strong></p><ul><li><code>octree</code>: the <code>OctreeN2Merge</code> instance</li><li><code>particles</code>: the <code>ParticleVector</code> instance containing the particles to be merged</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the index of the grid cell in which particles are being merged</li><li><code>species</code>: the index of the species being merged</li></ul></div></section></article><h2 id="Grids"><a class="docs-heading-anchor" href="#Grids">Grids</a><a id="Grids-1"></a><a class="docs-heading-anchor-permalink" href="#Grids" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.Cell1D" href="#Merzbild.Cell1D"><code>Merzbild.Cell1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Cell1D</code></pre><p>Cell element of a 1-D grid</p><p><strong>Fields</strong></p><ul><li><code>xlo</code>: coordinate of the left end of the element</li><li><code>xhi</code>: coordinate of the right end of the element </li><li><code>V</code>: cell volume</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cell" href="#Merzbild.get_cell"><code>Merzbild.get_cell</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cell(grid1duniform::Grid1DUniform, x_pos)</code></pre><p>Find in which cell of 1-D uniform grid the coordinate is located</p><p><strong>Positional arguments</strong></p><ul><li><code>grid1duniform</code>: the 1-D uniform grid</li><li><code>x_pos</code>: the 3-D coordinate vector for the which the cell index is to be determined (only the first component is used)</li></ul></div></section></article><h2 id="Particle-movement"><a class="docs-heading-anchor" href="#Particle-movement">Particle movement</a><a id="Particle-movement-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-movement" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.convect_single_particle!" href="#Merzbild.convect_single_particle!"><code>Merzbild.convect_single_particle!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convect_single_particle!(rng, grid::Grid1DUniform, boundaries::MaxwellWalls1D, particle, species, Δt)</code></pre><p>Convect a singe particle on a 1-D uniform grid.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>grid</code>: the grid on which the convection is performed</li><li><code>boundaries</code>: the <code>MaxwellWalls1D</code> struct describing the boundaries (it is assumed that the wall with index 1 is the left wall and   the wall with index 2 is the right wall)</li><li><code>particles</code>: the particle to be convected</li><li><code>species</code>: the index of the species being convected</li><li><code>Δt</code>: the convection timestep</li></ul></div></section><section><div><pre><code class="language-julia hljs">convect_single_particle!(rng, grid::Grid1DUniform, boundaries::MaxwellWalls1D, particle, species, surf_props::SurfProps, mass, Δt)</code></pre><p>Convect a singe particle on a 1-D uniform grid, updating surface properties if it collides with a wall.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>grid</code>: the grid on which the convection is performed</li><li><code>boundaries</code>: the <code>MaxwellWalls1D</code> struct describing the boundaries (it is assumed that the wall with index 1 is the left wall and   the wall with index 2 is the right wall)</li><li><code>particles</code>: the particle to be convected</li><li><code>species</code>: the index of the species being convected</li><li><code>surf_props</code>: the <code>SurfProps</code> struct where the computed surface properties will be stored</li><li><code>mass</code>: the molecular mass of the species</li><li><code>Δt</code>: the convection timestep</li></ul></div></section></article><h2 id="Particle-surface-interactions"><a class="docs-heading-anchor" href="#Particle-surface-interactions">Particle-surface interactions</a><a id="Particle-surface-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-surface-interactions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.specular_reflection_x!" href="#Merzbild.specular_reflection_x!"><code>Merzbild.specular_reflection_x!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">specular_reflection_x!(particle)</code></pre><p>Perform specular reflection of a particle in the x direction.</p><p><strong>Positional arguments</strong></p><ul><li><code>particle</code>: the <code>Particle</code> instance for which the velocity is reflected</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.diffuse_reflection_x!" href="#Merzbild.diffuse_reflection_x!"><code>Merzbild.diffuse_reflection_x!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">specular_reflection_x!(particle)</code></pre><p>Perform diffuse reflection of a particle, assuming the wall is orthogonal to the x axis.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>particle</code>: the <code>Particle</code> instance for which the velocity is reflected</li><li><code>wall_reflection_v_sq</code>: the squared thermal velocity of the species reflected at the wall temperature</li><li><code>wall_normal_sign</code>: sign of the wall normal</li><li><code>wall_v</code>: wall velocity vector</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.reflect_particle_x!" href="#Merzbild.reflect_particle_x!"><code>Merzbild.reflect_particle_x!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reflect_particle_x!(rng, particle, wall_reflection_v_sq, wall_normal_sign, wall_v, wall_accommodation)</code></pre><p>Reflect particle from a Maxwell wall orthogonal to the x axis.</p><p><strong>Positional arguments</strong></p><ul><li><code>rng</code>: the random number generator</li><li><code>particle</code>: the <code>Particle</code> instance for which the velocity is reflected</li><li><code>wall_reflection_v_sq</code>: the squared thermal velocity of the species reflected at the wall temperature</li><li><code>wall_normal_sign</code>: sign of the wall normal</li><li><code>wall_v</code>: wall velocity vector</li><li><code>wall_accommodation</code>: wall accommodation coefficient</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_surface_incident!" href="#Merzbild.update_surface_incident!"><code>Merzbild.update_surface_incident!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_surface_incident!(particle, species, surf_props, surface_element_id)</code></pre><p>Update surface properties for surface element <code>surface_element_id</code> for an incident particle.</p><p><strong>Positional arguments</strong></p><ul><li><code>particle</code>: the particle hitting the surface before its velocity is updated</li><li><code>species</code>: the species of the particle</li><li><code>surf_props</code>: the <code>SurfProps</code> instance</li><li><code>surface_element_id</code>: id of the surface element which the particle has impacted</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_surface_reflected!" href="#Merzbild.update_surface_reflected!"><code>Merzbild.update_surface_reflected!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_surface_incident!(particle, species, surf_props, surface_element_id)</code></pre><p>Update surface properties for surface element <code>surface_element_id</code> for a reflected particle.</p><p><strong>Positional arguments</strong></p><ul><li><code>particle</code>: the particle hitting the surface after its velocity is updated</li><li><code>species</code>: the species of the particle</li><li><code>surf_props</code>: the <code>SurfProps</code> instance</li><li><code>surface_element_id</code>: id of the surface element which the particle has impacted</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.surface_props_scale!" href="#Merzbild.surface_props_scale!"><code>Merzbild.surface_props_scale!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_props_scale!(species, surf_props, species_data, Δt)</code></pre><p>Scale computed surface properties using the molecular mass of species, the inverse of the timestep, and the inverse surface area.</p><p><strong>Positional arguments</strong></p><ul><li><code>species</code>: the species of the particle</li><li><code>surf_props</code>: the <code>SurfProps</code> instance</li><li><code>species_data</code>: the vector of <code>SpeciesData</code> of the chemical species in the flow</li><li><code>Δt</code>: the timestep over which the surface properties were computed</li></ul></div></section></article><h2 id="I/O"><a class="docs-heading-anchor" href="#I/O">I/O</a><a id="I/O-1"></a><a class="docs-heading-anchor-permalink" href="#I/O" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.AbstractNCDataHolder" href="#Merzbild.AbstractNCDataHolder"><code>Merzbild.AbstractNCDataHolder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractNCDataHolder</code></pre><p>Abstract type that holds NetCDF-output related data for I/O</p></div></section></article><h2 id="Constants"><a class="docs-heading-anchor" href="#Constants">Constants</a><a id="Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.c_light" href="#Merzbild.c_light"><code>Merzbild.c_light</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Speed of light, m/s</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.eV" href="#Merzbild.eV"><code>Merzbild.eV</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electron-Volt, K</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.eV_J" href="#Merzbild.eV_J"><code>Merzbild.eV_J</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electron-Volt, J</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.eV_J_inv" href="#Merzbild.eV_J_inv"><code>Merzbild.eV_J_inv</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>1.0/eV[J], 1/J (or equivalent to how much 1 J is equal to expressed in eV)</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.twopi" href="#Merzbild.twopi"><code>Merzbild.twopi</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><span>$2 \pi$</span></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.e_mass_div_electron_volt" href="#Merzbild.e_mass_div_electron_volt"><code>Merzbild.e_mass_div_electron_volt</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electron mass divided by 1 eV, kg/J</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.direction_signs" href="#Merzbild.direction_signs"><code>Merzbild.direction_signs</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Positive and negative direction signs</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.q_e" href="#Merzbild.q_e"><code>Merzbild.q_e</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Elementary charge, C</p></div></section></article><h2 id="Misc"><a class="docs-heading-anchor" href="#Misc">Misc</a><a id="Misc-1"></a><a class="docs-heading-anchor-permalink" href="#Misc" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_thermal_velocity" href="#Merzbild.compute_thermal_velocity"><code>Merzbild.compute_thermal_velocity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_thermal_velocity(m, T)</code></pre><p>Compute the thermal velocity <span>$\sqrt(2kT/m)$</span>.</p><p><strong>Positional arguments</strong></p><ul><li><code>m</code>: the molecular mass of the species</li><li><code>T</code>: the temperature</li></ul><p><strong>Returns</strong></p><p>The thermal velocity</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.binary_search" href="#Merzbild.binary_search"><code>Merzbild.binary_search</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">binary_search(x, val)</code></pre><p>Binary search for value <code>val</code> in a sorted array <code>x</code>. Finds the position <code>mid</code> such that <code>x[mid] &lt; val &lt; x[mid+1]</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>x</code>: the sorted array to be searched</li><li><code>val</code>: the value to search for</li></ul><p><strong>Returns</strong></p><ul><li><code>-1</code> if <code>val &lt; x[1]</code></li><li><code>0</code> if <code>val &gt; x[end]</code></li><li>Otherwise, returns the index <code>mid</code> satisfying <code>x[mid] &lt; val &lt; x[mid+1]</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.linear_interpolation" href="#Merzbild.linear_interpolation"><code>Merzbild.linear_interpolation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_interpolation(x, y, val, pos, lower_limit, upper_limit)</code></pre><p>Perform linear interpolation of a tabulated function <code>y(x)</code>, given a parameter value <code>val</code>, a sorted array of values of <code>x</code> and corresponding values of <code>y</code>, as well as the index of the closest values of <code>x</code> to <code>val</code>. In case <code>val</code> is outside of the limits of <code>x</code>, return placeholder values. That is, given that <code>x[pos] &lt; val &lt; x[pos+1]</code>, we want to interpolate <code>y(val)</code> given that <code>y[x[pos]] = y[pos], y[x[pos+1]] = y[pos+1]</code>.</p><p><strong>Positional arguments</strong></p><ul><li><code>x</code>: the vector of values of the parameter of the function to be interpolated</li><li><code>y</code>: the vector of the corresponding function values</li><li><code>val</code>: the value of the parameter at which the function is to be interpolated</li><li><code>pos</code>: the index of the element in <code>x</code> such that <code>x[pos] &lt; val &lt; x[pos+1]</code>,    or <code>-1</code> if <code>val &lt; x[1]</code>, <code>0</code> if <code>val &gt; x[end]</code></li><li><code>lower_limit</code>: the value to return if <code>val &lt; x[1]</code></li><li><code>upper_limit</code>: the value to return if <code>val &gt; x[end]</code></li></ul><p><strong>Returns</strong></p><ul><li>The linearly interpolated value of <code>y(val)</code> if <code>x[1] &lt;= val &lt;= x[end]</code></li><li><code>lower_limit</code>, if <code>val &lt; x[1]</code></li><li><code>upper_limit</code>, if <code>val &gt; x[end]</code></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_mixed_moment" href="#Merzbild.compute_mixed_moment"><code>Merzbild.compute_mixed_moment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_mixed_moment(particles, pia, cell, species, powers; sum_scaler=1.0, res_scaler=1.0)</code></pre><p>Compute mixed velocity moment of particles in a cell: <span>$\sum_i w_i v_{x,i}^{p_x} v_{y,i}^{p_y} v_{z,i}^{p_z}$</span></p><p><strong>Positional arguments</strong></p><ul><li><code>particles</code>: the <code>Vector</code> of <code>ParticleVector</code>s containing all the particles in a simulation</li><li><code>pia</code>: the <code>ParticleIndexerArray</code> instance</li><li><code>cell</code>: the cell in which the moment is being computed</li><li><code>species</code>: the species for which the mixed moment is being computed</li><li><code>powers</code>: a <code>Vector</code> of the powers to which the x-, y-, and z-components of the velocity are to be raised</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>sum_scaler</code>: during the summation over the particles, scale each summand by this factor   potentially reduce round-off issues</li><li><code>res_scaler</code>: scaling factor by which to multiply the result at the end</li></ul></div></section></article><h2 id="NNLS"><a class="docs-heading-anchor" href="#NNLS">NNLS</a><a id="NNLS-1"></a><a class="docs-heading-anchor-permalink" href="#NNLS" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.solve!" href="#Merzbild.solve!"><code>Merzbild.solve!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Algorithm NNLS: NONNEGATIVE LEAST SQUARES</p><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 15, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p><p>GIVEN AN M BY N MATRIX, A, AND AN M-VECTOR, B,  COMPUTE AN N-VECTOR, X, THAT SOLVES THE LEAST SQUARES PROBLEM                  A * X = B  SUBJECT TO X .GE. 0</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.construct_householder!" href="#Merzbild.construct_householder!"><code>Merzbild.construct_householder!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CONSTRUCTION AND/OR APPLICATION OF A SINGLE HOUSEHOLDER TRANSFORMATION..     Q = I + U*(U**T)/B</p><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 12, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.fastview" href="#Merzbild.fastview"><code>Merzbild.fastview</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>UnsafeVectorView only works for isbitstype types. For other types, we&#39;re already allocating lots of memory elsewhere, so creating a new View is fine.</p><p>This function looks type-unstable, but the isbitstype(T) test can be evaluated by the compiler, so the result is actually type-stable.</p></div></section><section><div><p>Fallback for non-contiguous arrays, for which UnsafeVectorView does not make sense.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.solve_triangular_system!" href="#Merzbild.solve_triangular_system!"><code>Merzbild.solve_triangular_system!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 15, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.UnsafeVectorView" href="#Merzbild.UnsafeVectorView"><code>Merzbild.UnsafeVectorView</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Views in Julia still allocate some memory (since they need to keep a reference to the original array). This type allocates no memory and does no bounds checking. Use it with caution.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.orthogonal_rotmat" href="#Merzbild.orthogonal_rotmat"><code>Merzbild.orthogonal_rotmat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>COMPUTE ORTHOGONAL ROTATION MATRIX.. The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 12, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p><p>COMPUTE.. MATRIX   (C, S) SO THAT (C, S)(A) = (SQRT(A<strong>2+B</strong>2))                       (-S,C)         (-S,C)(B)   (   0          )    COMPUTE SIG = SQRT(A<strong>2+B</strong>2)       SIG IS COMPUTED LAST TO ALLOW FOR THE POSSIBILITY THAT       SIG MAY BE IN THE SAME LOCATION AS A OR B .</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.apply_householder!" href="#Merzbild.apply_householder!"><code>Merzbild.apply_householder!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CONSTRUCTION AND/OR APPLICATION OF A SINGLE HOUSEHOLDER TRANSFORMATION..     Q = I + U*(U**T)/B</p><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 12, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reference_public/">« Public API reference</a><a class="docs-footer-nextpage" href="../benchmarks/">Benchmarks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Thursday 3 July 2025 16:21">Thursday 3 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
