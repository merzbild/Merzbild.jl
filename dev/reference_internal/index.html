<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internal API reference · Merzbild</title><meta name="title" content="Internal API reference · Merzbild"/><meta property="og:title" content="Internal API reference · Merzbild"/><meta property="twitter:title" content="Internal API reference · Merzbild"/><meta name="description" content="Documentation for Merzbild."/><meta property="og:description" content="Documentation for Merzbild."/><meta property="twitter:description" content="Documentation for Merzbild."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Merzbild</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview_capabilities/">Overview of capabilities</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../overview_blocks/">Overview of basic building blocks</a></li><li><a class="tocitem" href="../overview_fixedweight/">Fixed-weight DSMC simulations</a></li><li><a class="tocitem" href="../overview_varweight/">Variable-weight DSMC simulations</a></li><li><a class="tocitem" href="../overview_1d/">1D DSMC simulations</a></li><li><a class="tocitem" href="../overview_fp/">Fokker-Planck simulations</a></li></ul></li><li><a class="tocitem" href="../reference_public/">Public API reference</a></li><li class="is-active"><a class="tocitem" href>Internal API reference</a><ul class="internal"><li><a class="tocitem" href="#Particle-indexing"><span>Particle indexing</span></a></li><li><a class="tocitem" href="#Loading-species-and-interaction-data"><span>Loading species and interaction data</span></a></li><li><a class="tocitem" href="#Sampling"><span>Sampling</span></a></li><li><a class="tocitem" href="#Collision-computations"><span>Collision computations</span></a></li><li><a class="tocitem" href="#Merging"><span>Merging</span></a></li><li><a class="tocitem" href="#Grids"><span>Grids</span></a></li><li><a class="tocitem" href="#Particle-surface-interactions"><span>Particle-surface interactions</span></a></li><li><a class="tocitem" href="#Constants"><span>Constants</span></a></li><li><a class="tocitem" href="#Misc"><span>Misc</span></a></li><li><a class="tocitem" href="#NNLS"><span>NNLS</span></a></li></ul></li><li><a class="tocitem" href="../benchmarks/">Benchmarks</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internal API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internal API reference</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Merzbild.jl-internal-API-reference"><a class="docs-heading-anchor" href="#Merzbild.jl-internal-API-reference">Merzbild.jl internal API reference</a><a id="Merzbild.jl-internal-API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#Merzbild.jl-internal-API-reference" title="Permalink"></a></h1><p>The public API functions are exported by the module</p><h2 id="Particle-indexing"><a class="docs-heading-anchor" href="#Particle-indexing">Particle indexing</a><a id="Particle-indexing-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-indexing" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.map_cont_index" href="#Merzbild.map_cont_index"><code>Merzbild.map_cont_index</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>map a continuous index in <code>[0, n_local-1]</code> to an index in the particle array given particle_indexer struct describing the split</p></div></section><section><div><p>map a continuous index in <code>[0, n_local-1]</code> to an index in the particle array given particle_indexer struct describing the split</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_indexer_new_lower_count" href="#Merzbild.update_particle_indexer_new_lower_count"><code>Merzbild.update_particle_indexer_new_lower_count</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update particle indexer when we reduced the particle count</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_indexer_new_particle" href="#Merzbild.update_particle_indexer_new_particle"><code>Merzbild.update_particle_indexer_new_particle</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update particle indexer when we add a new particle</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex" href="#Base.getindex"><code>Base.getindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get underlying particle in ParticleVector with index i</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.setindex!" href="#Base.setindex!"><code>Base.setindex!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Set underlying particle in ParticleVector with index i to a new particle</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length" href="#Base.length"><code>Base.length</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get length of a <code>ParticleVector</code>` instance</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.resize!" href="#Base.resize!"><code>Base.resize!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Resize a <code>ParticleVector</code>` instance</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update the buffer of unused <code>Particle</code>s in a <code>ParticleVector</code> instance</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{ParticleVector, Any, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update the buffer of unused <code>Particle</code>s in a <code>ParticleVector</code> instance</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dummy function in case <code>Vector{Particle}</code> is used and not a <code>ParticleVector</code>`</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any}" href="#Merzbild.update_particle_buffer_new_particle-Tuple{Vector{Particle}, Any}"><code>Merzbild.update_particle_buffer_new_particle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Dummy function in case <code>Vector{Particle}</code> is used and not a <code>ParticleVector</code>`</p></div></section></article><h2 id="Loading-species-and-interaction-data"><a class="docs-heading-anchor" href="#Loading-species-and-interaction-data">Loading species and interaction data</a><a id="Loading-species-and-interaction-data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-species-and-interaction-data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.find_species_in_db" href="#Merzbild.find_species_in_db"><code>Merzbild.find_species_in_db</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find a chemical species in an LXCat-format XML file</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.load_elastic_data" href="#Merzbild.load_elastic_data"><code>Merzbild.load_elastic_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Load elastic electron-neutral scattering data from an LXCat-format XML file</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.load_ionization_data" href="#Merzbild.load_ionization_data"><code>Merzbild.load_ionization_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Load electron-impact ionization data from an LXCat-format XML file</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_mu_ref" href="#Merzbild.compute_mu_ref"><code>Merzbild.compute_mu_ref</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute reference viscosity</p></div></section></article><h2 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.create_unit_dvgrid" href="#Merzbild.create_unit_dvgrid"><code>Merzbild.create_unit_dvgrid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>generate a grid with extent [-1.0,1.0]x[-1.0,1.0]x[-1.0,1.0]</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.create_noiseless_dvgrid" href="#Merzbild.create_noiseless_dvgrid"><code>Merzbild.create_noiseless_dvgrid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>generate a grid [-vx<em>max, vx</em>max]x[-vy<em>max, vy</em>max]x[-vz<em>max, vz</em>max]</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.create_vdf" href="#Merzbild.create_vdf"><code>Merzbild.create_vdf</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>create an empty VDF of size nx * ny * nz</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sample_bkw!" href="#Merzbild.sample_bkw!"><code>Merzbild.sample_bkw!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sample from the BKW distribution with temperature T for a species with mass m     at t=0 and add a velocity offset</p></div></section><section><div><p>Sample from the BKW distribution with temperature T for a species with mass m     at t=0 and add a velocity offset</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.evaluate_distribution_on_grid!" href="#Merzbild.evaluate_distribution_on_grid!"><code>Merzbild.evaluate_distribution_on_grid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Evaluate a distribution on a discrete velocity grid</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sample_maxwellian_single!" href="#Merzbild.sample_maxwellian_single!"><code>Merzbild.sample_maxwellian_single!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sample a single particle from a Maxwell distribution with temperature T for a species with mass m     and add a velocity offset</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sample_maxwellian!" href="#Merzbild.sample_maxwellian!"><code>Merzbild.sample_maxwellian!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sample <code>nparticles</code> particles from a Maxwell distribution with temperature T for a species with mass m     and add a velocity offset</p></div></section><section><div><p>Sample <code>nparticles</code> particles from a Maxwell distribution with temperature T for a species with mass m     and add a velocity offset</p></div></section></article><h2 id="Collision-computations"><a class="docs-heading-anchor" href="#Collision-computations">Collision computations</a><a id="Collision-computations-1"></a><a class="docs-heading-anchor-permalink" href="#Collision-computations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_n_coll_single_species" href="#Merzbild.compute_n_coll_single_species"><code>Merzbild.compute_n_coll_single_species</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute number of collisions, collisions between particles of same species</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_n_coll_two_species" href="#Merzbild.compute_n_coll_two_species"><code>Merzbild.compute_n_coll_two_species</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute number of collisions, collisions between particles of different species</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_vhs_factor" href="#Merzbild.compute_vhs_factor"><code>Merzbild.compute_vhs_factor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute interaction-specific factor <span>$\pi D_{VHS}^2 (2 T_{ref,VHS}/m_r)^{(\omega_{VHS} - 0.5)} \frac{1}{\Gamma(2.5 - \omega_{VHS})}$</span></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_com!" href="#Merzbild.compute_com!"><code>Merzbild.compute_com!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute center of mass velocity</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_g!" href="#Merzbild.compute_g!"><code>Merzbild.compute_g!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute relative velocity</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_g_new_ionization!" href="#Merzbild.compute_g_new_ionization!"><code>Merzbild.compute_g_new_ionization!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute post-ionization relative velocity</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scatter_vhs!" href="#Merzbild.scatter_vhs!"><code>Merzbild.scatter_vhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Scatter two particles using VHS scattering</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scatter_electron_vhs!" href="#Merzbild.scatter_electron_vhs!"><code>Merzbild.scatter_electron_vhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Scatter an electron off of a neutral particle using VHS scattering</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scatter_ionization_electrons!" href="#Merzbild.scatter_ionization_electrons!"><code>Merzbild.scatter_ionization_electrons!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Scatter two electrons</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.sigma_vhs" href="#Merzbild.sigma_vhs"><code>Merzbild.sigma_vhs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute the VHS cross-section for a given interaction</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_tabulated_cs_constant_continuation" href="#Merzbild.compute_tabulated_cs_constant_continuation"><code>Merzbild.compute_tabulated_cs_constant_continuation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute a cross-section from tabulated data, continuing with first and last values if outside of range</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_tabulated_cs_zero_continuation" href="#Merzbild.compute_tabulated_cs_zero_continuation"><code>Merzbild.compute_tabulated_cs_zero_continuation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute a cross-section from tabulated data, continuing with 0.0 if outside of range</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_cross_sections_only!" href="#Merzbild.compute_cross_sections_only!"><code>Merzbild.compute_cross_sections_only!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute electron-impact ionization and excitation cross-sections, and electron-neutral elastic scattering Return collision energy in eV</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_cross_sections!" href="#Merzbild.compute_cross_sections!"><code>Merzbild.compute_cross_sections!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute electron-impact ionization and excitation cross-sections, and electron-neutral elastic scattering Plus compute total cross-section and probabilites of different processes</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cs_total" href="#Merzbild.get_cs_total"><code>Merzbild.get_cs_total</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the value of the total collision cross-section for electron-neutral interactions</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cs_elastic" href="#Merzbild.get_cs_elastic"><code>Merzbild.get_cs_elastic</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the value of the elastic scattering electron-neutral cross-section</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cs_ionization" href="#Merzbild.get_cs_ionization"><code>Merzbild.get_cs_ionization</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the value of the electron-impact ionization cross-section</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_ionization_threshold" href="#Merzbild.get_ionization_threshold"><code>Merzbild.get_ionization_threshold</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the ionization threshold</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_electron_energy_split" href="#Merzbild.get_electron_energy_split"><code>Merzbild.get_electron_energy_split</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the way electron energy is split during ionization</p></div></section></article><h2 id="Merging"><a class="docs-heading-anchor" href="#Merging">Merging</a><a id="Merging-1"></a><a class="docs-heading-anchor-permalink" href="#Merging" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.GridCell" href="#Merzbild.GridCell"><code>Merzbild.GridCell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct for keeping track of merging-related quantities in a velocity grid cell</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_velocity_extent!" href="#Merzbild.compute_velocity_extent!"><code>Merzbild.compute_velocity_extent!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute extent of velocity grid based on temperature in the cell</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_grid_index" href="#Merzbild.compute_grid_index"><code>Merzbild.compute_grid_index</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute index of particle on the merging grid</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.clear_merging_grid!" href="#Merzbild.clear_merging_grid!"><code>Merzbild.clear_merging_grid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reset merging grid</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_grid!" href="#Merzbild.compute_grid!"><code>Merzbild.compute_grid!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute properties for all cells on the merging grid</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_new_particles!" href="#Merzbild.compute_new_particles!"><code>Merzbild.compute_new_particles!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute new particles based on the grid cell properties without checking particle locations</p></div></section><section><div><p>Compute post-merge particles</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.vx_sign" href="#Merzbild.vx_sign"><code>Merzbild.vx_sign</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return sign of velocity vx of an octant in velocity space</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.vy_sign" href="#Merzbild.vy_sign"><code>Merzbild.vy_sign</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return sign of velocity vy of an octant in velocity space</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.vz_sign" href="#Merzbild.vz_sign"><code>Merzbild.vz_sign</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return sign of velocity vz of an octant in velocity space</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.check_speed_bound" href="#Merzbild.check_speed_bound"><code>Merzbild.check_speed_bound</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check speed bound</p></div></section><section><div><p>Check speed bound with multiplier</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.base_multi_index_moments" href="#Merzbild.base_multi_index_moments"><code>Merzbild.base_multi_index_moments</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Base multi indices corresponding to conservation of mass momentum and energy components</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_w_total_v0!" href="#Merzbild.compute_w_total_v0!"><code>Merzbild.compute_w_total_v0!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute total computational weight of particles and mean velocity, as well as velocity bounds</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.ccm" href="#Merzbild.ccm"><code>Merzbild.ccm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute unweighted centered moment</p></div></section><section><div><p>Compute unweighted centered moment</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_and_rhs!" href="#Merzbild.compute_lhs_and_rhs!"><code>Merzbild.compute_lhs_and_rhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute LHS matrix and RHS vector for NNLS merging</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_and_rhs_rate_preserving!" href="#Merzbild.compute_lhs_and_rhs_rate_preserving!"><code>Merzbild.compute_lhs_and_rhs_rate_preserving!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute LHS matrix and RHS vector for NNLS merging, rate-preserving version</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_particles_additional!" href="#Merzbild.compute_lhs_particles_additional!"><code>Merzbild.compute_lhs_particles_additional!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute additional LHS columns for additional particles</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_lhs_particles_additional_rate_preserving!" href="#Merzbild.compute_lhs_particles_additional_rate_preserving!"><code>Merzbild.compute_lhs_particles_additional_rate_preserving!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute additional LHS columns for additional particles, rate preserving</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scale_lhs_rhs!" href="#Merzbild.scale_lhs_rhs!"><code>Merzbild.scale_lhs_rhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Scale LHS and RHS</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.scale_lhs_rhs_rate_preserving!" href="#Merzbild.scale_lhs_rhs_rate_preserving!"><code>Merzbild.scale_lhs_rhs_rate_preserving!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Scale LHS and RHS, rate-preserving version</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_post_merge_particles_nnls!" href="#Merzbild.compute_post_merge_particles_nnls!"><code>Merzbild.compute_post_merge_particles_nnls!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute post-merge particles</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.OctreeCell" href="#Merzbild.OctreeCell"><code>Merzbild.OctreeCell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Struct holding data needed for refinement of an octree bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.OctreeFullCell" href="#Merzbild.OctreeFullCell"><code>Merzbild.OctreeFullCell</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Octree bin properties required to merge the particles in a bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.fill_bins" href="#Merzbild.fill_bins"><code>Merzbild.fill_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Fill the octree bins struct with zero data</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.fill_full_bins" href="#Merzbild.fill_full_bins"><code>Merzbild.fill_full_bins</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Fill the octree full bins struct with zero data</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.clear_octree!" href="#Merzbild.clear_octree!"><code>Merzbild.clear_octree!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reset octree</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.resize_octree_buffers!" href="#Merzbild.resize_octree_buffers!"><code>Merzbild.resize_octree_buffers!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Resize octree buffers</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_octant" href="#Merzbild.compute_octant"><code>Merzbild.compute_octant</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute octant of particle velocity relative to a <code>v_middle</code>`</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.bin_bounds_inherit!" href="#Merzbild.bin_bounds_inherit!"><code>Merzbild.bin_bounds_inherit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute new bin bounds of sub-bin inheriting bounds of parent bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.bin_bounds_recompute!" href="#Merzbild.bin_bounds_recompute!"><code>Merzbild.bin_bounds_recompute!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Recompute bin bounds based on particle velocities</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_v_mean!" href="#Merzbild.compute_v_mean!"><code>Merzbild.compute_v_mean!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute mean velocity of bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_v_median!" href="#Merzbild.compute_v_median!"><code>Merzbild.compute_v_median!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute median velocity of bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_new_bin_id" href="#Merzbild.get_new_bin_id"><code>Merzbild.get_new_bin_id</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get index of a newly created bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.split_bin!" href="#Merzbild.split_bin!"><code>Merzbild.split_bin!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sort particles into sub-bins, split bin, keeping track of which sub-bins particles end up in</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_bin_props!" href="#Merzbild.compute_bin_props!"><code>Merzbild.compute_bin_props!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute properties in a bin required for merging</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_bin_post_merge_np" href="#Merzbild.get_bin_post_merge_np"><code>Merzbild.get_bin_post_merge_np</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get number of post-merge particles in a bin</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.init_octree!" href="#Merzbild.init_octree!"><code>Merzbild.init_octree!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Initialize the top bin in an octree</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.merge_octree_N2_based!" href="#Merzbild.merge_octree_N2_based!"><code>Merzbild.merge_octree_N2_based!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Perform N:2 merging</p></div></section></article><h2 id="Grids"><a class="docs-heading-anchor" href="#Grids">Grids</a><a id="Grids-1"></a><a class="docs-heading-anchor-permalink" href="#Grids" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.Cell1D" href="#Merzbild.Cell1D"><code>Merzbild.Cell1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Cell element of a 1-D grid</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.get_cell" href="#Merzbild.get_cell"><code>Merzbild.get_cell</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find cell in 1-D uniform grid given coordinates of a particle</p></div></section></article><h2 id="Particle-surface-interactions"><a class="docs-heading-anchor" href="#Particle-surface-interactions">Particle-surface interactions</a><a id="Particle-surface-interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-surface-interactions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.specular_reflection_x!" href="#Merzbild.specular_reflection_x!"><code>Merzbild.specular_reflection_x!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Perform specular reflection of a particle in the x direction</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.diffuse_reflection_x!" href="#Merzbild.diffuse_reflection_x!"><code>Merzbild.diffuse_reflection_x!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Perform diffuse reflection of a particle in the x direction</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.reflect_particle_x!" href="#Merzbild.reflect_particle_x!"><code>Merzbild.reflect_particle_x!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reflect particle in the x direction </p></div></section></article><h2 id="Constants"><a class="docs-heading-anchor" href="#Constants">Constants</a><a id="Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.c_light" href="#Merzbild.c_light"><code>Merzbild.c_light</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Speed of light, m/s</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.eV" href="#Merzbild.eV"><code>Merzbild.eV</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electron-Volt, K</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.eV_J" href="#Merzbild.eV_J"><code>Merzbild.eV_J</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electron-Volt, J</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.eV_J_inv" href="#Merzbild.eV_J_inv"><code>Merzbild.eV_J_inv</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>1.0/eV[J], 1/J (or equivalent to how much 1 J is equal to expressed in eV)</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.twopi" href="#Merzbild.twopi"><code>Merzbild.twopi</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><span>$2 \pi$</span></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.e_mass_div_electron_volt" href="#Merzbild.e_mass_div_electron_volt"><code>Merzbild.e_mass_div_electron_volt</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Electron mass divided by 1 eV, kg/J</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.direction_signs" href="#Merzbild.direction_signs"><code>Merzbild.direction_signs</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Positive and negative direction signs</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.q_e" href="#Merzbild.q_e"><code>Merzbild.q_e</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Elementary charge, C</p></div></section></article><h2 id="Misc"><a class="docs-heading-anchor" href="#Misc">Misc</a><a id="Misc-1"></a><a class="docs-heading-anchor-permalink" href="#Misc" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_thermal_velocity" href="#Merzbild.compute_thermal_velocity"><code>Merzbild.compute_thermal_velocity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>compute thermal velocity: <span>$\sqrt(2kT/m)$</span></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.binary_search" href="#Merzbild.binary_search"><code>Merzbild.binary_search</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Binary search for value <code>val</code> in array <code>x</code></p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.linear_interpolation" href="#Merzbild.linear_interpolation"><code>Merzbild.linear_interpolation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Perform linear interpolation between two neighbouring values in y</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.compute_mixed_moment" href="#Merzbild.compute_mixed_moment"><code>Merzbild.compute_mixed_moment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute mixed moment of particles in a cell</p></div></section></article><h2 id="NNLS"><a class="docs-heading-anchor" href="#NNLS">NNLS</a><a id="NNLS-1"></a><a class="docs-heading-anchor-permalink" href="#NNLS" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.solve!" href="#Merzbild.solve!"><code>Merzbild.solve!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Algorithm NNLS: NONNEGATIVE LEAST SQUARES</p><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 15, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p><p>GIVEN AN M BY N MATRIX, A, AND AN M-VECTOR, B,  COMPUTE AN N-VECTOR, X, THAT SOLVES THE LEAST SQUARES PROBLEM                  A * X = B  SUBJECT TO X .GE. 0</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.construct_householder!" href="#Merzbild.construct_householder!"><code>Merzbild.construct_householder!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CONSTRUCTION AND/OR APPLICATION OF A SINGLE HOUSEHOLDER TRANSFORMATION..     Q = I + U*(U**T)/B</p><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 12, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.fastview" href="#Merzbild.fastview"><code>Merzbild.fastview</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>UnsafeVectorView only works for isbitstype types. For other types, we&#39;re already allocating lots of memory elsewhere, so creating a new View is fine.</p><p>This function looks type-unstable, but the isbitstype(T) test can be evaluated by the compiler, so the result is actually type-stable.</p></div></section><section><div><p>Fallback for non-contiguous arrays, for which UnsafeVectorView does not make sense.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.solve_triangular_system!" href="#Merzbild.solve_triangular_system!"><code>Merzbild.solve_triangular_system!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 15, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.UnsafeVectorView" href="#Merzbild.UnsafeVectorView"><code>Merzbild.UnsafeVectorView</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Views in Julia still allocate some memory (since they need to keep a reference to the original array). This type allocates no memory and does no bounds checking. Use it with caution.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.orthogonal_rotmat" href="#Merzbild.orthogonal_rotmat"><code>Merzbild.orthogonal_rotmat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>COMPUTE ORTHOGONAL ROTATION MATRIX.. The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 12, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p><p>COMPUTE.. MATRIX   (C, S) SO THAT (C, S)(A) = (SQRT(A<strong>2+B</strong>2))                       (-S,C)         (-S,C)(B)   (   0          )    COMPUTE SIG = SQRT(A<strong>2+B</strong>2)       SIG IS COMPUTED LAST TO ALLOW FOR THE POSSIBILITY THAT       SIG MAY BE IN THE SAME LOCATION AS A OR B .</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Merzbild.apply_householder!" href="#Merzbild.apply_householder!"><code>Merzbild.apply_householder!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CONSTRUCTION AND/OR APPLICATION OF A SINGLE HOUSEHOLDER TRANSFORMATION..     Q = I + U*(U**T)/B</p><p>The original version of this code was developed by Charles L. Lawson and Richard J. Hanson at Jet Propulsion Laboratory 1973 JUN 12, and published in the book &quot;SOLVING LEAST SQUARES PROBLEMS&quot;, Prentice-HalL, 1974. Revised FEB 1995 to accompany reprinting of the book by SIAM.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reference_public/">« Public API reference</a><a class="docs-footer-nextpage" href="../benchmarks/">Benchmarks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 19 December 2024 20:02">Thursday 19 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
